import{j as e}from"./query.D2_a4YYZ.js";import{r as d}from"./react-vendor.BaVwoRKI.js";import{L as u,C as o}from"./Card.DBbmFfHk.js";import{B as T}from"./Button.B1aGBMaa.js";import{b as $,d as F,s as z,p as U}from"./api.BBwiE9lX.js";import"./router.BYkwE9TY.js";const W=()=>{const[g,w]=d.useState([]),[b,P]=d.useState([]),[A,E]=d.useState([]),[f,L]=d.useState([]),[D,N]=d.useState(!0),[y,C]=d.useState(null),[m,G]=d.useState(""),[h,R]=d.useState("coverage");d.useEffect(()=>{S()},[]);const S=async()=>{try{N(!0),C(null);const[s,r,i,t]=await Promise.all([$.list(),F.list(),z.list(),U.list()]);w(s.results||[]),P(r.results||[]),E(i.results||[]),L(t.results||[])}catch(s){C(s.message||"Failed to load skills data")}finally{N(!1)}},k=()=>{const s=new Map;A.forEach(t=>{s.set(t.name,{skillName:t.name,totalPeople:0,strengths:0,development:0,learning:0,expertCount:0,advancedCount:0,intermediateCount:0,beginnerCount:0,coverage:"gap"})});const r=m?g.filter(t=>t.department?.toString()===m):g;f.forEach(t=>{const c=g.find(x=>x.id===t.person);if(!c||m&&c.department?.toString()!==m)return;const n=t.skillTagName||"Unknown",a=s.get(n);a&&(a.totalPeople++,t.skillType==="strength"?a.strengths++:t.skillType==="development"?a.development++:t.skillType==="learning"&&a.learning++,t.proficiencyLevel==="expert"?a.expertCount++:t.proficiencyLevel==="advanced"?a.advancedCount++:t.proficiencyLevel==="intermediate"?a.intermediateCount++:t.proficiencyLevel==="beginner"&&a.beginnerCount++)});const i=r.length;return s.forEach(t=>{const c=i>0?t.strengths/i:0,n=t.expertCount+t.advancedCount;n>=3&&c>=.3?t.coverage="excellent":n>=2&&c>=.2?t.coverage="good":t.totalPeople>0?t.coverage="limited":t.coverage="gap"}),Array.from(s.values()).filter(t=>t.totalPeople>0||t.coverage==="gap").sort((t,c)=>{const n={excellent:0,good:1,limited:2,gap:3},a=n[t.coverage],x=n[c.coverage];return a!==x?a-x:c.totalPeople-t.totalPeople})},M=()=>b.map(s=>{const r=g.filter(l=>l.department===s.id),i=r.map(l=>l.id),t=f.filter(l=>i.includes(l.person)),c=new Map;t.forEach(l=>{if(l.skillType==="strength"){const j=c.get(l.skillTagName||"")||0;c.set(l.skillTagName||"",j+1)}});const n=Array.from(c.entries()).sort(([,l],[,j])=>j-l).slice(0,5).map(([l])=>l),a=new Set;f.forEach(l=>{!i.includes(l.person)&&l.skillType==="strength"&&a.add(l.skillTagName||"")});const x=new Set(t.map(l=>l.skillTagName||"")),I=Array.from(a).filter(l=>!x.has(l)).slice(0,3);return{departmentId:s.id,departmentName:s.name,peopleCount:r.length,skillsCoverage:[],topSkills:n,skillGaps:I}}).filter(s=>s.peopleCount>0),O=()=>{const s=k(),r=s.length,i=s.filter(a=>a.coverage==="excellent").length,t=s.filter(a=>a.coverage==="good").length,c=s.filter(a=>a.coverage==="limited").length,n=s.filter(a=>a.coverage==="gap").length;return{total:r,excellent:i,good:t,limited:c,gaps:n}};if(D)return e.jsx(u,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-[#969696]",children:"Loading skills analysis..."})})});if(y)return e.jsx(u,{children:e.jsxs(o,{className:"bg-red-500/20 border-red-500/30 p-6",children:[e.jsx("div",{className:"text-red-400 font-medium mb-2",children:"Error Loading Skills Data"}),e.jsx("div",{className:"text-red-300 text-sm",children:y}),e.jsx(T,{onClick:S,className:"mt-4 bg-red-500 hover:bg-red-400",children:"Retry"})]})});const v=k(),B=M(),p=O();return e.jsx(u,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-[#cccccc]",children:"Skills Dashboard"}),e.jsxs("p",{className:"text-[#969696] mt-2",children:["Team skills analysis, coverage, and gap identification",m&&e.jsxs("span",{className:"block mt-1",children:["Filtered by: ",b.find(s=>s.id?.toString()===m)?.name]})]})]}),e.jsx("div",{className:"flex items-center gap-4 mt-4 sm:mt-0",children:e.jsxs("select",{value:m,onChange:s=>G(s.target.value),className:"px-3 py-2 text-sm bg-[#3e3e42] border border-[#3e3e42] rounded text-[#cccccc] focus:border-[#007acc] focus:outline-none",children:[e.jsx("option",{value:"",children:"All Departments"}),b.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})})]}),e.jsx("div",{className:"flex gap-2",children:[{key:"coverage",label:"Skills Coverage"},{key:"gaps",label:"Skills Gaps"},{key:"departments",label:"By Department"}].map(({key:s,label:r})=>e.jsx(T,{onClick:()=>R(s),variant:h===s?"primary":"ghost",size:"sm",children:r},s))}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs(o,{className:"bg-[#2d2d30] border-[#3e3e42] p-4",children:[e.jsx("div",{className:"text-[#969696] text-sm",children:"Total Skills"}),e.jsx("div",{className:"text-2xl font-bold text-[#cccccc]",children:p.total})]}),e.jsxs(o,{className:"bg-[#2d2d30] border-[#3e3e42] p-4",children:[e.jsx("div",{className:"text-[#969696] text-sm",children:"Excellent Coverage"}),e.jsx("div",{className:"text-2xl font-bold text-emerald-400",children:p.excellent})]}),e.jsxs(o,{className:"bg-[#2d2d30] border-[#3e3e42] p-4",children:[e.jsx("div",{className:"text-[#969696] text-sm",children:"Good Coverage"}),e.jsx("div",{className:"text-2xl font-bold text-blue-400",children:p.good})]}),e.jsxs(o,{className:"bg-[#2d2d30] border-[#3e3e42] p-4",children:[e.jsx("div",{className:"text-[#969696] text-sm",children:"Limited Coverage"}),e.jsx("div",{className:"text-2xl font-bold text-amber-400",children:p.limited})]}),e.jsxs(o,{className:"bg-[#2d2d30] border-[#3e3e42] p-4",children:[e.jsx("div",{className:"text-[#969696] text-sm",children:"Skills Gaps"}),e.jsx("div",{className:"text-2xl font-bold text-red-400",children:p.gaps})]})]}),h==="coverage"&&e.jsxs(o,{className:"bg-[#2d2d30] border-[#3e3e42] p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-[#cccccc] mb-4",children:"Skills Coverage Analysis"}),e.jsxs("div",{className:"space-y-4",children:[v.map(s=>e.jsxs("div",{className:"border-b border-[#3e3e42] pb-4 last:border-b-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"font-medium text-[#cccccc]",children:s.skillName}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${s.coverage==="excellent"?"bg-emerald-500/20 text-emerald-400":s.coverage==="good"?"bg-blue-500/20 text-blue-400":s.coverage==="limited"?"bg-amber-500/20 text-amber-400":"bg-red-500/20 text-red-400"}`,children:s.coverage})]}),e.jsxs("div",{className:"text-sm text-[#969696]",children:[s.totalPeople," people"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[#969696]",children:"Strengths"}),e.jsx("div",{className:"text-emerald-400 font-medium",children:s.strengths})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[#969696]",children:"Learning"}),e.jsx("div",{className:"text-blue-400 font-medium",children:s.learning})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[#969696]",children:"Expert/Advanced"}),e.jsx("div",{className:"text-purple-400 font-medium",children:s.expertCount+s.advancedCount})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[#969696]",children:"Intermediate/Beginner"}),e.jsx("div",{className:"text-[#cccccc] font-medium",children:s.intermediateCount+s.beginnerCount})]})]})]},s.skillName)),v.length===0&&e.jsx("div",{className:"text-center py-8 text-[#969696]",children:"No skills data available for the selected filters"})]})]}),h==="gaps"&&e.jsxs(o,{className:"bg-[#2d2d30] border-[#3e3e42] p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-[#cccccc] mb-4",children:"Skills Gaps & Recommendations"}),e.jsxs("div",{className:"space-y-4",children:[v.filter(s=>s.coverage==="gap"||s.coverage==="limited").map(s=>e.jsxs("div",{className:"p-4 bg-amber-500/10 border border-amber-500/30 rounded",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium text-amber-400",children:s.skillName}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${s.coverage==="gap"?"bg-red-500/20 text-red-400":"bg-amber-500/20 text-amber-400"}`,children:s.coverage==="gap"?"No Coverage":"Limited Coverage"})]}),e.jsx("div",{className:"text-sm text-amber-300 mb-2",children:s.coverage==="gap"?"No team members have this skill as a strength. Consider hiring or training.":`Only ${s.strengths} team member(s) have this as a strength. Consider expanding coverage.`}),s.development>0&&e.jsxs("div",{className:"text-xs text-blue-400",children:["ðŸ’¡ ",s.development," team member(s) are currently developing this skill"]})]},s.skillName)),v.filter(s=>s.coverage==="gap"||s.coverage==="limited").length===0&&e.jsx("div",{className:"text-center py-8 text-emerald-400",children:"ðŸŽ‰ Great job! No critical skills gaps detected in your team."})]})]}),h==="departments"&&e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:B.map(s=>e.jsxs(o,{className:"bg-[#2d2d30] border-[#3e3e42] p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-[#cccccc]",children:s.departmentName}),e.jsxs("span",{className:"text-sm text-[#969696]",children:[s.peopleCount," people"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-[#cccccc] mb-2",children:"ðŸŒŸ Top Skills"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.topSkills.slice(0,5).map(r=>e.jsx("span",{className:"px-2 py-1 bg-emerald-500/20 text-emerald-400 rounded text-xs",children:r},r)),s.topSkills.length===0&&e.jsx("span",{className:"text-xs text-[#969696]",children:"No skills data available"})]})]}),s.skillGaps.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-[#cccccc] mb-2",children:"âš ï¸ Potential Gaps"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.skillGaps.map(r=>e.jsx("span",{className:"px-2 py-1 bg-amber-500/20 text-amber-400 rounded text-xs",children:r},r))}),e.jsx("div",{className:"text-xs text-[#969696] mt-1",children:"Skills present in other departments but not here"})]})]})]},s.departmentId))})]})})};export{W as SkillsDashboard};
//# sourceMappingURL=index.C2uokzqE.js.map
