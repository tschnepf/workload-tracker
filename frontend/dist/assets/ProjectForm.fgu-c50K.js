import{j as e}from"./query.D2_a4YYZ.js";import{r as a}from"./react-vendor.BaVwoRKI.js";import{e as x}from"./api.BBwiE9lX.js";import{L as B,C as D}from"./Card.DBbmFfHk.js";import{B as S}from"./Button.B1aGBMaa.js";import{I as b}from"./Input.CAfEA-5q.js";import{u as O,b as $}from"./router.BYkwE9TY.js";const _=()=>{const C=O(),{id:l}=$(),o=!!l,[s,d]=a.useState({name:"",status:"active",client:"",description:"",startDate:"",estimatedHours:void 0,projectNumber:""}),[j,m]=a.useState(!1),[N,h]=a.useState(null),[i,f]=a.useState({}),[g,P]=a.useState([]),[y,u]=a.useState([]),[E,p]=a.useState(!1);a.useEffect(()=>{o&&l&&A()},[o,l]),a.useEffect(()=>{(async()=>{try{const r=await x.getClients();P(r),u(r)}catch(r){console.error("Failed to load clients:",r)}})()},[]);const A=async()=>{try{m(!0);const t=await x.get(parseInt(l));d(t)}catch{h("Failed to load project")}finally{m(!1)}},k=()=>{const t={};return s.name?.trim()||(t.name="Project name is required"),s.client?.trim()||(t.client="Client is required"),f(t),Object.keys(t).length===0},F=async t=>{if(t.preventDefault(),!!k())try{m(!0),h(null);const r={...s,name:s.name?.trim(),client:s.client?.trim(),description:s.description?.trim(),estimatedHours:s.estimatedHours||void 0,startDate:s.startDate?.trim()||null,endDate:null};o&&l?await x.update(parseInt(l),r):await x.create(r),C("/projects")}catch(r){console.error("Project form submission error:",r);let c=r.message||`Failed to ${o?"update":"create"} project`;if(r.status===400&&r.response&&(console.error("Validation errors:",r.response),typeof r.response=="object")){const w=Object.entries(r.response).map(([L,v])=>`${L}: ${Array.isArray(v)?v.join(", "):v}`).join("; ");w&&(c=`Validation errors: ${w}`)}h(c)}finally{m(!1)}},n=(t,r)=>{d(c=>({...c,[t]:r})),i[t]&&f(c=>({...c,[t]:""}))},H=t=>{if(d(r=>({...r,client:t})),t.trim()==="")u(g);else{const r=g.filter(c=>c.toLowerCase().includes(t.toLowerCase()));u(r)}p(!0),i.client&&f(r=>({...r,client:""}))},I=t=>{d(r=>({...r,client:t})),p(!1),u(g)};return e.jsx(B,{children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-[#cccccc]",children:o?"Edit Project":"Create New Project"}),e.jsx("p",{className:"text-[#969696] mt-1",children:o?"Update project information":"Add a new project to track assignments"})]}),N&&e.jsx(D,{className:"bg-red-500/20 border-red-500/50 p-4 mb-6",children:e.jsx("div",{className:"text-red-400",children:N})}),e.jsx(D,{className:"bg-[#2d2d30] border-[#3e3e42] p-6",children:e.jsxs("form",{onSubmit:F,className:"space-y-6",children:[e.jsx("div",{children:e.jsx(b,{label:"Project Name",name:"name",value:s.name||"",onChange:t=>n("name",t.target.value),placeholder:"e.g., Website Redesign, Mobile App",required:!0,error:i.name,className:"bg-[#3e3e42] border-[#3e3e42] text-[#cccccc]"})}),e.jsxs("div",{className:"relative",children:[e.jsxs("label",{className:"block text-sm font-medium text-[#cccccc] mb-2",children:["Client ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",value:s.client||"",onChange:t=>H(t.target.value),onFocus:()=>p(!0),onBlur:()=>{setTimeout(()=>p(!1),200)},placeholder:"e.g., Acme Corp, Internal",className:"w-full px-3 py-2 rounded-md border text-sm transition-colors bg-[#3e3e42] border-[#3e3e42] text-[#cccccc] placeholder-[#969696] focus:border-blue-500 focus:ring-1 focus:ring-blue-500 focus:outline-none"}),i.client&&e.jsx("p",{className:"text-red-400 text-xs mt-1",children:i.client}),E&&y.length>0&&e.jsx("div",{className:"absolute z-50 w-full mt-1 bg-[#2d2d30] border border-[#3e3e42] rounded-md shadow-lg max-h-60 overflow-auto",children:y.map(t=>e.jsx("div",{className:"px-3 py-2 cursor-pointer hover:bg-[#3e3e42] text-[#cccccc] text-sm",onClick:()=>I(t),children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-[#cccccc] mb-2",children:"Status"}),e.jsxs("select",{value:s.status||"active",onChange:t=>n("status",t.target.value),className:"w-full px-3 py-2 rounded-md border text-sm transition-colors bg-[#3e3e42] border-[#3e3e42] text-[#cccccc] focus:border-blue-500 focus:ring-1 focus:ring-blue-500 focus:outline-none",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"active_ca",children:"Active CA"}),e.jsx("option",{value:"on_hold",children:"On Hold"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-[#cccccc] mb-2",children:"Description"}),e.jsx("textarea",{value:s.description||"",onChange:t=>n("description",t.target.value),rows:4,className:"w-full px-3 py-2 rounded-md border text-sm transition-colors bg-[#3e3e42] border-[#3e3e42] text-[#cccccc] placeholder-[#969696] focus:border-blue-500 focus:ring-1 focus:ring-blue-500 focus:outline-none resize-none",placeholder:"Brief description of the project"})]}),e.jsxs("div",{children:[e.jsx(b,{label:"Start Date (Optional)",name:"startDate",type:"date",value:s.startDate||"",onChange:t=>n("startDate",t.target.value),className:"bg-[#3e3e42] border-[#3e3e42] text-[#cccccc]"}),e.jsx("p",{className:"text-[#969696] text-sm mt-1",children:"Leave blank if project start date is not yet determined"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{children:e.jsx(b,{label:"Estimated Hours",name:"estimatedHours",type:"number",min:"0",step:"1",value:s.estimatedHours||"",onChange:t=>n("estimatedHours",t.target.value?parseInt(t.target.value):void 0),placeholder:"Total project hours",className:"bg-[#3e3e42] border-[#3e3e42] text-[#cccccc]"})}),e.jsx("div",{children:e.jsx(b,{label:"Project Number",name:"projectNumber",value:s.projectNumber||"",onChange:t=>n("projectNumber",t.target.value),placeholder:"e.g., PRJ-2024-001",className:"bg-[#3e3e42] border-[#3e3e42] text-[#cccccc]"})})]}),e.jsxs("div",{className:"flex justify-between pt-4",children:[e.jsx(S,{type:"button",variant:"ghost",onClick:()=>C("/projects"),disabled:j,children:"Cancel"}),e.jsx(S,{type:"submit",variant:"primary",disabled:j,children:j?"Saving...":o?"Update Project":"Create Project"})]})]})})]})})};export{_ as default};
//# sourceMappingURL=ProjectForm.fgu-c50K.js.map
