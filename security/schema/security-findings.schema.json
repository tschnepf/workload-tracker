{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://example.com/security-findings.schema.json",
  "title": "Security Findings",
  "type": "array",
  "items": {
    "type": "object",
    "required": [
      "id",
      "rule_id",
      "title",
      "severity",
      "risk_score",
      "factors",
      "confidence",
      "category",
      "path",
      "line"
    ],
    "properties": {
      "id": { "type": "string" },
      "rule_id": { "type": "string" },
      "title": { "type": "string" },
      "severity": { "type": "string", "enum": ["Critical", "High", "Medium", "Low"] },
      "risk_score": { "type": "number" },
      "factors": {
        "type": "object",
        "required": ["exploitability", "impact", "exposure", "detection", "mitigation"],
        "properties": {
          "exploitability": { "type": "number", "minimum": 1, "maximum": 5 },
          "impact": { "type": "number", "minimum": 1, "maximum": 5 },
          "exposure": { "type": "number", "minimum": 1, "maximum": 5 },
          "detection": { "type": "number", "minimum": 1, "maximum": 5 },
          "mitigation": { "type": "number", "minimum": 1, "maximum": 5 }
        },
        "additionalProperties": false
      },
      "confidence": { "type": "string", "enum": ["high", "medium", "low"] },
      "category": { "type": "string" },
      "cwe": { "type": "string" },
      "cvss": { "type": "string" },
      "repo": { "type": "string" },
      "path": { "type": "string" },
      "line": { "type": "integer", "minimum": 1 },
      "end_line": { "type": "integer", "minimum": 1 },
      "fingerprint": { "type": "string" },
      "owner": { "type": "string" },
      "status": { "type": "string", "enum": ["open", "triaged", "accepted-risk", "fixed"] },
      "tags": { "type": "array", "items": { "type": "string" } },
      "evidence": { "type": "string" },
      "attack_vector": { "type": "string" },
      "business_impact": { "type": "string" },
      "technical_impact": { "type": "string" },
      "fix": { "type": "string" },
      "fix_prereqs": { "type": "array", "items": { "type": "string" } },
      "references": { "type": "array", "items": { "type": "string", "format": "uri" } },
      "suppression": {
        "type": "object",
        "properties": {
          "reason": { "type": "string" },
          "approver": { "type": "string" },
          "expires": { "type": "string", "format": "date" }
        },
        "additionalProperties": false
      },
      "first_seen": { "type": "string", "format": "date-time" }
    },
    "additionalProperties": false
  }
}

